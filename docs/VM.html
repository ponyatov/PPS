<title>VM/js</title>

<style>

* {
	background: black; color: lightgreen;
	font-family: monospace, monospace; font-size: 2vh;
	margin:0;
}

textarea,button { width:100%; }
textarea { caret-color: red; } 
button { background: darkslategray; height: 7vmin; }

#stack,#pad { color:cyan; }

#cmd { position: absolute; bottom:0; }

</style>

<pre id=log>Hello
</pre>

<pre id=stack>stack:</pre>

<div id=cmd>

<textarea id=meta rows=11>// PEG grammar

{ out('Hello') } // init code runs first

FORTH   = (( comment / word ) _ ) *
comment = [#\\][^\n]*
_       = [ \t\r\n]*

word
  = w:[a-zA-Z0-9_\+\-\.]+
    { out(join(w)) }

</textarea>

<textarea id=pad rows=5># command

-01 +02.30 +4e-5 0xDeadBeef 0b1101 \ numbers

</textarea>

<button id=go onclick="go()">GO</button>
</div>

<script src=PEG.js></script>
<script>

function join(dat) { return dat.join("") }

function out(some) {
	var S = '' 
	JSON.stringify(some).match(/.{1,44}/g)
		.forEach(function(item,i,arr) {
			S += item + '\n'})
	log.innerText += S
}

function go() {
	log.innerText = ''
	try { peg.generate(meta.value).parse(pad.value) }
	catch(e) { log.innerText = "error:\n" + out(e) }
}

function keydown(event) {
	if (event.ctrlKey & event.key == 'Enter') go()
}

window.onload = function() {
	document.body.onkeydown = keydown
}

</script>
